tAssistance.page.SimilarityPage = {
	"model": {},
	"dom": {},
	"ctler": {},
	"data": {}
};

tAssistance.page.SimilarityPage.data.example1 = 
{"id":"315","obsels":[{"id":"315","obsels":[{"begin":1404391610690,"end":1404391610690,"user":"test3juillet","index":"0","type":"load","value":{"type":"load","string":"|in","char":"a"}},{"begin":1404391610690,"end":1404391610690,"user":"test3juillet","index":"1","type":"nav","value":{"type":"nav","string":"R","char":"r"}},{"begin":1404391610690,"end":1404391610690,"user":"test3juillet","index":"2","type":"index","value":{"type":"index","string":"0","char":"i"}},{"begin":1404391610690,"end":1404391610690,"user":"test3juillet","index":"3","type":"nav","value":{"type":"nav","string":"R","char":"r"}},{"begin":1404391610690,"end":1404391610690,"user":"test3juillet","index":"4","type":"index","value":{"type":"index","string":"1","char":"i"}},{"begin":1404391610690,"end":1404391610690,"user":"test3juillet","index":"5","type":"nav","value":{"type":"nav","string":"R","char":"r"}},{"begin":1404391610690,"end":1404391610690,"user":"test3juillet","index":"6","type":"index","value":{"type":"index","string":"2","char":"i"}},{"begin":1404391610690,"end":1404391610690,"user":"test3juillet","index":"7","type":"nav","value":{"type":"nav","string":"En","char":"e"}},{"begin":1404391610690,"end":1404391610690,"user":"test3juillet","index":"8","type":"input","value":{"type":"input","string":"Ii","char":"t"}},{"begin":1404391610690,"end":1404391610690,"user":"test3juillet","index":"9","type":"input","value":{"type":"input","string":"Ia","char":"t"}},{"begin":1404391610690,"end":1404391610690,"user":"test3juillet","index":"10","type":"input","value":{"type":"input","string":"Ia","char":"t"}},{"begin":1404391610690,"end":1404391610690,"user":"test3juillet","index":"11","type":"input","value":{"type":"input","string":"Ia","char":"t"}},{"begin":1404391610690,"end":1404391610690,"user":"test3juillet","index":"12","type":"input","value":{"type":"input","string":"Ia","char":"t"}},{"begin":1404391610690,"end":1404391610690,"user":"test3juillet","index":"13","type":"nav","value":{"type":"nav","string":"En","char":"e"}},{"begin":1404391610690,"end":1404391610690,"user":"test3juillet","index":"14","type":"index","value":{"type":"index","string":"2","char":"i"}},{"begin":1404391610690,"end":1404391610690,"user":"test3juillet","index":"15","type":"index","value":{"type":"index","string":"4","char":"i"}},{"begin":1404391610690,"end":1404391610690,"user":"test3juillet","index":"16","type":"search","value":{"type":"search","string":"Mf[[code]][[1]]","char":"s"}},{"begin":1404391610690,"end":1404391610690,"user":"test3juillet","index":"17","type":"load","value":{"type":"load","string":"|ri","char":"a"}},{"begin":1404391610690,"end":1404391610690,"user":"test3juillet","index":"18","type":"nav","value":{"type":"nav","string":"En","char":"e"}},{"begin":1404391610690,"end":1404391610690,"user":"test3juillet","index":"19","type":"go","value":{"type":"go","string":"Gd0","char":"g"}}],"type":"group","value":"Sds","subject":"test3juillet","computer":"PC BNF COM1","begin":1404391610690,"end":1404391610690,"str":"ariririettttteiisaeg"},{"id":"316","obsels":[{"begin":1404391627457,"end":1404391627457,"type":"load","user":"test3juillet","index":"0","value":{"type":"load","string":"|in0_","char":"a"},"str":""},{"begin":1404391627457,"end":1404391627457,"type":"index","user":"test3juillet","index":"1","value":{"type":"index","string":"*0","char":"i"},"str":""},{"begin":1404391627457,"end":1404391627457,"type":"escape","user":"test3juillet","index":"2","value":{"type":"escape","string":"Qu","char":"x"},"str":""}],"type":"group","value":"Sd","subject":"test3juillet","computer":"PC BNF COM1","begin":1404391627457,"end":1404391627457,"str":"aix"},{"id":"317","obsels":[{"begin":1404391634071,"end":1404391634071,"user":"test3juillet","index":"0","type":"load","value":{"type":"load","string":"|rt","char":"a"}},{"begin":1404391634071,"end":1404391634071,"user":"test3juillet","index":"1","type":"index","value":{"type":"index","string":"-1","char":"i"}},{"begin":1404391634071,"end":1404391634071,"user":"test3juillet","index":"2","type":"nav","value":{"type":"nav","string":"R","char":"r"}},{"begin":1404391634071,"end":1404391634071,"user":"test3juillet","index":"3","type":"index","value":{"type":"index","string":"0","char":"i"}},{"begin":1404391634071,"end":1404391634071,"user":"test3juillet","index":"4","type":"nav","value":{"type":"nav","string":"R","char":"r"}},{"begin":1404391634071,"end":1404391634071,"user":"test3juillet","index":"5","type":"index","value":{"type":"index","string":"1","char":"i"}},{"begin":1404391634071,"end":1404391634071,"user":"test3juillet","index":"6","type":"nav","value":{"type":"nav","string":"R","char":"r"}},{"begin":1404391634071,"end":1404391634071,"user":"test3juillet","index":"7","type":"index","value":{"type":"index","string":"2","char":"i"}},{"begin":1404391634071,"end":1404391634071,"user":"test3juillet","index":"8","type":"nav","value":{"type":"nav","string":"En","char":"e"}},{"begin":1404391634071,"end":1404391634071,"user":"test3juillet","index":"9","type":"input","value":{"type":"input","string":"Ii","char":"t"}},{"begin":1404391634071,"end":1404391634071,"user":"test3juillet","index":"10","type":"input","value":{"type":"input","string":"Ia","char":"t"}},{"begin":1404391634071,"end":1404391634071,"user":"test3juillet","index":"11","type":"input","value":{"type":"input","string":"Ia","char":"t"}},{"begin":1404391634071,"end":1404391634071,"user":"test3juillet","index":"12","type":"input","value":{"type":"input","string":"Ia","char":"t"}},{"begin":1404391634071,"end":1404391634071,"user":"test3juillet","index":"13","type":"input","value":{"type":"input","string":"Ia","char":"t"}},{"begin":1404391634071,"end":1404391634071,"user":"test3juillet","index":"14","type":"input","value":{"type":"input","string":"Ia","char":"t"}},{"begin":1404391634071,"end":1404391634071,"user":"test3juillet","index":"15","type":"input","value":{"type":"input","string":"Ia","char":"t"}},{"begin":1404391634071,"end":1404391634071,"user":"test3juillet","index":"16","type":"input","value":{"type":"input","string":"Ia","char":"t"}},{"begin":1404391634071,"end":1404391634071,"user":"test3juillet","index":"17","type":"nav","value":{"type":"nav","string":"En","char":"e"}},{"begin":1404391634071,"end":1404391634071,"user":"test3juillet","index":"18","type":"index","value":{"type":"index","string":"2","char":"i"}},{"begin":1404391634071,"end":1404391634071,"user":"test3juillet","index":"19","type":"index","value":{"type":"index","string":"4","char":"i"}},{"begin":1404391634071,"end":1404391634071,"user":"test3juillet","index":"20","type":"search","value":{"type":"search","string":"Mf[[occulte]][[4]]","char":"s"}},{"begin":1404391634071,"end":1404391634071,"user":"test3juillet","index":"21","type":"load","value":{"type":"load","string":"|ri","char":"a"}},{"begin":1404391634071,"end":1404391634071,"user":"test3juillet","index":"22","type":"nav","value":{"type":"nav","string":"En","char":"e"}},{"begin":1404391634071,"end":1404391634071,"user":"test3juillet","index":"23","type":"go","value":{"type":"go","string":"Gd0","char":"g"}}],"type":"group","value":"Sds","subject":"test3juillet","computer":"PC BNF COM1","begin":1404391634071,"end":1404391634071,"str":"airiririetttttttteiisaeg"},{"id":"318","obsels":[{"begin":1404391674939,"end":1404391674939,"user":"test3juillet","index":"0","type":"load","value":{"type":"load","string":"|in","char":"a"}},{"begin":1404391674939,"end":1404391674939,"user":"test3juillet","index":"1","type":"index","value":{"type":"index","string":"-1","char":"i"}},{"begin":1404391674939,"end":1404391674939,"user":"test3juillet","index":"2","type":"nav","value":{"type":"nav","string":"R","char":"r"}},{"begin":1404391674939,"end":1404391674939,"user":"test3juillet","index":"3","type":"index","value":{"type":"index","string":"0","char":"i"}},{"begin":1404391674939,"end":1404391674939,"user":"test3juillet","index":"4","type":"nav","value":{"type":"nav","string":"R","char":"r"}},{"begin":1404391674939,"end":1404391674939,"user":"test3juillet","index":"5","type":"index","value":{"type":"index","string":"1","char":"i"}},{"begin":1404391674939,"end":1404391674939,"user":"test3juillet","index":"6","type":"nav","value":{"type":"nav","string":"R","char":"r"}},{"begin":1404391674939,"end":1404391674939,"user":"test3juillet","index":"7","type":"index","value":{"type":"index","string":"2","char":"i"}},{"begin":1404391674939,"end":1404391674939,"user":"test3juillet","index":"8","type":"nav","value":{"type":"nav","string":"En","char":"e"}},{"begin":1404391674939,"end":1404391674939,"user":"test3juillet","index":"9","type":"input","value":{"type":"input","string":"Ii","char":"t"}},{"begin":1404391674939,"end":1404391674939,"user":"test3juillet","index":"10","type":"input","value":{"type":"input","string":"Ia","char":"t"}},{"begin":1404391674939,"end":1404391674939,"user":"test3juillet","index":"11","type":"input","value":{"type":"input","string":"Ia","char":"t"}},{"begin":1404391674939,"end":1404391674939,"user":"test3juillet","index":"12","type":"nav","value":{"type":"nav","string":"En","char":"e"}},{"begin":1404391674939,"end":1404391674939,"user":"test3juillet","index":"13","type":"index","value":{"type":"index","string":"2","char":"i"}},{"begin":1404391674939,"end":1404391674939,"user":"test3juillet","index":"14","type":"index","value":{"type":"index","string":"4","char":"i"}},{"begin":1404391674939,"end":1404391674939,"user":"test3juillet","index":"15","type":"search","value":{"type":"search","string":"Mf[[dr]][[4]]","char":"s"}},{"begin":1404391674939,"end":1404391674939,"user":"test3juillet","index":"16","type":"load","value":{"type":"load","string":"|ri","char":"a"}},{"begin":1404391674939,"end":1404391674939,"user":"test3juillet","index":"17","type":"nav","value":{"type":"nav","string":"D","char":"d"}},{"begin":1404391674939,"end":1404391674939,"user":"test3juillet","index":"18","type":"index","value":{"type":"index","string":"4","char":"i"}},{"begin":1404391674939,"end":1404391674939,"user":"test3juillet","index":"19","type":"index","value":{"type":"index","string":"4","char":"i"}},{"begin":1404391674939,"end":1404391674939,"user":"test3juillet","index":"20","type":"index","value":{"type":"index","string":"4","char":"i"}},{"begin":1404391674939,"end":1404391674939,"user":"test3juillet","index":"21","type":"nav","value":{"type":"nav","string":"R","char":"r"}},{"begin":1404391674939,"end":1404391674939,"user":"test3juillet","index":"22","type":"index","value":{"type":"index","string":"5","char":"i"}},{"begin":1404391674939,"end":1404391674939,"user":"test3juillet","index":"23","type":"nav","value":{"type":"nav","string":"En","char":"e"}},{"begin":1404391674939,"end":1404391674939,"user":"test3juillet","index":"24","type":"go","value":{"type":"go","string":"Gd1","char":"g"}}],"type":"group","value":"Sds","subject":"test3juillet","computer":"PC BNF COM1","begin":1404391674939,"end":1404391674939,"str":"airiririettteiisadiiirieg"},{"id":"319","obsels":[{"begin":1404391700892,"end":1404391700892,"type":"load","user":"test3juillet","index":"0","value":{"type":"load","string":"|in1_","char":"a"},"str":""},{"begin":1404391700892,"end":1404391700892,"type":"index","user":"test3juillet","index":"1","value":{"type":"index","string":"*0","char":"i"},"str":""},{"begin":1404391700892,"end":1404391700892,"type":"escape","user":"test3juillet","index":"2","value":{"type":"escape","string":"Qu","char":"x"},"str":""}],"type":"group","value":"Sd","subject":"test3juillet","computer":"PC BNF COM1","begin":1404391700892,"end":1404391700892,"str":"aix"},{"id":"320","obsels":[{"begin":1404391715734,"end":1404391715734,"user":"test3juillet","index":"0","type":"load","value":{"type":"load","string":"|rt","char":"a"}},{"begin":1404391715734,"end":1404391715734,"user":"test3juillet","index":"1","type":"index","value":{"type":"index","string":"-1","char":"i"}},{"begin":1404391715734,"end":1404391715734,"user":"test3juillet","index":"2","type":"index","value":{"type":"index","string":"0","char":"i"}},{"begin":1404391715734,"end":1404391715734,"user":"test3juillet","index":"3","type":"nav","value":{"type":"nav","string":"R","char":"r"}},{"begin":1404391715734,"end":1404391715734,"user":"test3juillet","index":"4","type":"index","value":{"type":"index","string":"0","char":"i"}},{"begin":1404391715734,"end":1404391715734,"user":"test3juillet","index":"5","type":"nav","value":{"type":"nav","string":"R","char":"r"}},{"begin":1404391715734,"end":1404391715734,"user":"test3juillet","index":"6","type":"index","value":{"type":"index","string":"1","char":"i"}},{"begin":1404391715734,"end":1404391715734,"user":"test3juillet","index":"7","type":"nav","value":{"type":"nav","string":"R","char":"r"}},{"begin":1404391715734,"end":1404391715734,"user":"test3juillet","index":"8","type":"index","value":{"type":"index","string":"2","char":"i"}},{"begin":1404391715734,"end":1404391715734,"user":"test3juillet","index":"9","type":"nav","value":{"type":"nav","string":"En","char":"e"}},{"begin":1404391715734,"end":1404391715734,"user":"test3juillet","index":"10","type":"input","value":{"type":"input","string":"Ii","char":"t"}},{"begin":1404391715734,"end":1404391715734,"user":"test3juillet","index":"11","type":"input","value":{"type":"input","string":"Ia","char":"t"}},{"begin":1404391715734,"end":1404391715734,"user":"test3juillet","index":"12","type":"input","value":{"type":"input","string":"Ia","char":"t"}},{"begin":1404391715734,"end":1404391715734,"user":"test3juillet","index":"13","type":"nav","value":{"type":"nav","string":"En","char":"e"}},{"begin":1404391715734,"end":1404391715734,"user":"test3juillet","index":"14","type":"index","value":{"type":"index","string":"4","char":"i"}},{"begin":1404391715734,"end":1404391715734,"user":"test3juillet","index":"15","type":"search","value":{"type":"search","string":"Mf[[dr]][[4]]","char":"s"}},{"begin":1404391715734,"end":1404391715734,"user":"test3juillet","index":"16","type":"load","value":{"type":"load","string":"|ri","char":"a"}},{"begin":1404391715734,"end":1404391715734,"user":"test3juillet","index":"17","type":"index","value":{"type":"index","string":"4","char":"i"}},{"begin":1404391715734,"end":1404391715734,"user":"test3juillet","index":"18","type":"nav","value":{"type":"nav","string":"R","char":"r"}},{"begin":1404391715734,"end":1404391715734,"user":"test3juillet","index":"19","type":"index","value":{"type":"index","string":"5","char":"i"}},{"begin":1404391715734,"end":1404391715734,"user":"test3juillet","index":"20","type":"nav","value":{"type":"nav","string":"R","char":"r"}},{"begin":1404391715734,"end":1404391715734,"user":"test3juillet","index":"21","type":"index","value":{"type":"index","string":"6","char":"i"}},{"begin":1404391715734,"end":1404391715734,"user":"test3juillet","index":"22","type":"nav","value":{"type":"nav","string":"L","char":"l"}},{"begin":1404391715734,"end":1404391715734,"user":"test3juillet","index":"23","type":"index","value":{"type":"index","string":"5","char":"i"}},{"begin":1404391715734,"end":1404391715734,"user":"test3juillet","index":"24","type":"nav","value":{"type":"nav","string":"L","char":"l"}},{"begin":1404391715734,"end":1404391715734,"user":"test3juillet","index":"25","type":"index","value":{"type":"index","string":"4","char":"i"}},{"begin":1404391715734,"end":1404391715734,"user":"test3juillet","index":"26","type":"nav","value":{"type":"nav","string":"En","char":"e"}},{"begin":1404391715734,"end":1404391715734,"user":"test3juillet","index":"27","type":"go","value":{"type":"go","string":"Gd0","char":"g"}}],"type":"group","value":"Sds","subject":"test3juillet","computer":"PC BNF COM1","begin":1404391715734,"end":1404391715734,"str":"aiiriririettteisairirililieg"},{"id":"321","obsels":[{"begin":1404391736826,"end":1404391736826,"type":"load","user":"test3juillet","index":"0","value":{"type":"load","string":"|in0_","char":"a"},"str":""},{"begin":1404391736826,"end":1404391736826,"type":"index","user":"test3juillet","index":"1","value":{"type":"index","string":"*0","char":"i"},"str":""},{"begin":1404391736826,"end":1404391736826,"type":"escape","user":"test3juillet","index":"2","value":{"type":"escape","string":"Qu","char":"x"},"str":""}],"type":"group","value":"Sd","subject":"test3juillet","computer":"PC BNF COM1","begin":1404391736826,"end":1404391736826,"str":"aix"}],"type":"trace","subject":"test3juillet","computer":"PC BNF COM1","begin":1404391610690,"end":1404391610690} ;

tAssistance.SimilarityPage = function(trace_uri, user_id){
	
	var page = document.body.querySelector("[placeholder='page']");
	
	var params = {
			"obsels": tAssistance.page.SimilarityPage.data.example1.obsels
	};
	
	var buttons = tAssistance.page.SimilarityPage.ctler.ButtonMaker(params);
	
	page.appendChild(buttons);
	
	var table = tAssistance.page.SimilarityPage.ctler.TableMaker(params);
	
	page.appendChild(table);
	
	
};

tAssistance.page.SimilarityPage.ctler.TableMaker = function(params){
	var obsels = params.obsels;
	
	var table = document.createElement("table");
	$(table).addClass("table-bordered");
	table.setAttribute("id","sequences");
	$(table).addClass("table");
	
	var thead = document.createElement("thead");
	
	var tr = document.createElement("tr");
	
	thead.appendChild(tr);
	
	var th = document.createElement("th");
	th.innerHTML = "Subject";
	
	tr.appendChild(th);
	
	var th = document.createElement("th");
	th.innerHTML = "Activity";
	
	tr.appendChild(th);
	
	var th = document.createElement("th");
	th.innerHTML = "Seq ID";
	
	tr.appendChild(th);
	
	var th = document.createElement("th");
	th.innerHTML = "Sequence";
	
	tr.appendChild(th);
	
	table.appendChild(thead);
	
	var tbody = document.createElement("tbody");
	
	table.appendChild(tbody);
	
	for(var i in obsels){
		var obsel = obsels[i];
		
		var params = {
				"obsel": obsel	
		};
		
		var row = tAssistance.page.SimilarityPage.ctler.RowMaker(params);
		
		tbody.appendChild(row);
	}
	
	return table;	
};

tAssistance.page.SimilarityPage.ctler.RowMaker = function(params){
	var obsel = params.obsel;
	
	var row = document.createElement("tr");
	
	var td = document.createElement("td");
	td.innerHTML = obsel.subject;
	
	row.appendChild(td);
	
	var td = document.createElement("td");
	td.innerHTML = ozavocal.messages.en[obsel.value]; //moment(obsel.begin).fromNow();
		
	row.appendChild(td);
	
	var td = document.createElement("td");
	td.innerHTML = obsel.id;
		
	row.appendChild(td);

	var td = document.createElement("td");
	//td.innerHTML = "sequence1";
	
	var params = {
		"obsels": obsel.obsels	
	};
	
	var content = tAssistance.ui.sequenceobsel.ctler.SequenceObselMaker(params);
	
	td.appendChild(content);
		
	row.appendChild(td);
		
	return row;
};

tAssistance.page.SimilarityPage.ctler.ButtonMaker = function(params){
	var obsels = params.obsels;
	
	var buttons = tAssistance.page.SimilarityPage.dom.Buttons();
	
	var alpha = buttons.querySelector("[name='alpha']");
	
	var id = buttons.querySelector("[name='id']");
	
	var aclick_fn = function(){		
		
		return function(){
			
			var sequences = document.querySelector("#sequences");
			
			var new_obsels = tMining.SortAZ(obsels);
			
			var params = {
				"obsels": new_obsels	
			};		
			
			var table = tAssistance.page.SimilarityPage.ctler.TableMaker(params);
			
			$(sequences).replaceWith(table);
			
		};
		
	}();
	
	alpha.onclick = aclick_fn;
	
	var iclick_fn = function(){		
		
		return function(){
			
			var sequences = document.querySelector("#sequences");
			
			var new_obsels = tMining.SortId(obsels);
			
			var params = {
				"obsels": obsels	
			};		
			
			var table = tAssistance.page.SimilarityPage.ctler.TableMaker(params);
			
			$(sequences).replaceWith(table);
			
		};
		
	}();
	
	id.onclick = iclick_fn;
	
	return buttons;
};

tAssistance.page.SimilarityPage.dom.Buttons = function(){
	
	var btn_group = document.createElement("div");
	btn_group.setAttribute("class","btn-group");
	btn_group.setAttribute("role","group");
	$(btn_group).css("margin","5px");
	
	var btn_user_mode = document.createElement("button");
	btn_user_mode.setAttribute("name","id");
	btn_user_mode.setAttribute("class","btn btn-default");
	btn_user_mode.innerHTML="ID";
	
	var btn_doc_mode = document.createElement("button");
	btn_doc_mode.setAttribute("name","alpha");
	btn_doc_mode.setAttribute("class","btn btn-default");
	btn_doc_mode.innerHTML="Alphabetic";
	
	btn_group.appendChild(btn_user_mode);
	btn_group.appendChild(btn_doc_mode);
	
	return btn_group;
};


